{% extends 'base.html' %}
{% block title %}Sketches Â· TODO{% endblock %}
{% block content %}
<div class="space-y-6">
  <!-- Header -->
  <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
    <div class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold text-slate-900 flex items-center gap-3">
          <i class="fas fa-paint-brush text-purple-600"></i>
          Sketches
        </h1>
        <p class="text-slate-600 mt-1">Quick sketches and drawings</p>
      </div>
      <a href="{% url 'sketch_create' %}" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center gap-2">
        <i class="fas fa-plus"></i> New Sketch
      </a>
    </div>
  </div>

  <!-- Filters -->
  <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4">
    <div class="flex flex-wrap items-center gap-4">
      <div class="flex items-center gap-2">
        <label class="text-sm font-medium text-slate-700">Filter by Project:</label>
        <select id="projectFilter" class="border border-slate-300 rounded px-3 py-1 text-sm">
          <option value="">All Projects</option>
          {% for project in projects %}
            <option value="{{ project.id }}">{{ project.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="flex items-center gap-2">
        <label class="text-sm font-medium text-slate-700">Filter by Task:</label>
        <select id="taskFilter" class="border border-slate-300 rounded px-3 py-1 text-sm">
          <option value="">All Tasks</option>
          {% for task in tasks %}
            <option value="{{ task.id }}">{{ task.title }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
  </div>

  <!-- Sketches Grid -->
  {% if sketches %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
      {% for sketch in sketches %}
        <div class="bg-white border border-slate-200 rounded-xl p-4 hover:shadow-lg transition-all duration-200">
          <!-- Sketch Preview -->
          <div class="aspect-square bg-slate-50 rounded-lg mb-3 flex items-center justify-center overflow-hidden">
            {% if sketch.image_data %}
              <img src="{{ sketch.image_data }}" alt="{{ sketch.title }}" class="w-full h-full object-contain">
            {% else %}
              <div class="text-slate-400 text-center">
                <i class="fas fa-image text-4xl mb-2"></i>
                <p class="text-sm">No preview</p>
              </div>
            {% endif %}
          </div>
          
          <!-- Sketch Info -->
          <h3 class="font-medium text-slate-900 mb-2 line-clamp-2">{{ sketch.title }}</h3>
          
          {% if sketch.description %}
            <p class="text-sm text-slate-600 mb-3 line-clamp-2">{{ sketch.description }}</p>
          {% endif %}
          
          <!-- Project/Task Info -->
          <div class="space-y-1 mb-3">
            {% if sketch.project %}
              <div class="flex items-center gap-1 text-xs text-blue-600">
                <i class="fas fa-folder"></i>
                <span>{{ sketch.project.name }}</span>
              </div>
            {% endif %}
            {% if sketch.task %}
              <div class="flex items-center gap-1 text-xs text-green-600">
                <i class="fas fa-tasks"></i>
                <span>{{ sketch.task.title }}</span>
              </div>
            {% endif %}
          </div>
          
          <!-- Actions -->
          <div class="flex items-center justify-between">
            <span class="text-xs text-slate-500">{{ sketch.created_at|date:"M j, Y" }}</span>
            <div class="flex items-center gap-2">
              <a href="{% url 'sketch_detail' sketch.id %}" class="text-blue-600 hover:text-blue-700 text-sm">
                <i class="fas fa-eye"></i>
              </a>
              <a href="{% url 'sketch_edit' sketch.id %}" class="text-slate-600 hover:text-slate-700 text-sm">
                <i class="fas fa-edit"></i>
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-8 text-center">
      <i class="fas fa-paint-brush text-slate-400 text-4xl mb-4"></i>
      <h3 class="text-lg font-medium text-slate-900 mb-2">No Sketches Yet</h3>
      <p class="text-slate-600 mb-4">Create your first sketch to get started!</p>
      <a href="{% url 'sketch_create' %}" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
        <i class="fas fa-plus mr-2"></i>Create Sketch
      </a>
    </div>
  {% endif %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const projectFilter = document.getElementById('projectFilter');
    const taskFilter = document.getElementById('taskFilter');
    
    function applyFilters() {
        const projectId = projectFilter.value;
        const taskId = taskFilter.value;
        
        let url = window.location.pathname;
        const params = new URLSearchParams();
        
        if (projectId) params.append('project', projectId);
        if (taskId) params.append('task', taskId);
        
        if (params.toString()) {
            url += '?' + params.toString();
        }
        
        window.location.href = url;
    }
    
    projectFilter.addEventListener('change', applyFilters);
    taskFilter.addEventListener('change', applyFilters);
    
    // Set current values
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('project')) {
        projectFilter.value = urlParams.get('project');
    }
    if (urlParams.get('task')) {
        taskFilter.value = urlParams.get('task');
    }
});
</script>
{% endblock %}
